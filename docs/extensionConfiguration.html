<!DOCTYPE html>
<html>

<head>
    <link rel="shortcut icon" href="../favicon.ico" />
    <title>Tableau Write-back Extension</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/xpand.css">
    <link rel="stylesheet" href="../css/docs.css">
</head>

<body>    
    <div class="header sticky" id="myHeader">
        <div class="hc">
            <div class="hc-logo">
                <a class="xp-bar-item xp-center xp-button" href="https://www.xpand-it.com/" target="_blank" style="display: inline;padding-left: 0px"><img class='logo' src="../img/xpandit-logo.png"/></a>
            </div>
            <div class="hc-buttons">
                <div class="buttons">
                    <a href="../index.html" class="btn btn-md btn-light">Home</a>
                    <a href="./setGoogleSpreadsheet.html" class="btn btn-md btn-light">Spreadsheet</a>
                    <a href="./advancedConfiguration.html" class="btn btn-md btn-light">Advanced</a>
                </div>
            </div>
        </div>
    </div>

    <div class="content">
        <div class="cc">
            <div id="setup">
                <h2>Setup Extension Components</h2>
                <h3>Google Spreadsheet Endpoint</h3>

                <p>To allow write back data the extension needs an Endpoint to send the data.</p>
                <p>To allow a simple deploy you can copy this <a href="https://docs.google.com/spreadsheets/d/1LrUdE6xs0HM45Hc24L4qvMfVlouetQeSndbKgTNAN_I/copy">Google Spreadsheet</a> and configured it to allow the extension to send data to it;</p>
                <p>If you need a more detailed step-by-step setup follow the link: <a href="./setGoogleSpreadsheet.html" target="_blank">Spreadsheet Configuration</a></p>
                <p>After copying the Spreadsheed do the following:</p>
                <ol>
                    <li>Open the Spreadsheet;</li>
                    <li>Go to Extensions -> Apps Script;</li>
                    <li>You will see that there is already a script there. This  will be your REST API that will get the data from Tableau;</li>
                    <li>Select Deploy -> New deployment.</li>
                    <li>Under Description, you can place, for example, "Write-Back Free".</li>
                    <li>Under Execute the app as, select whose authorization the app should run with: your account (the developer's) or the account of the user who visits the app (see permissions).</li>
                    <li>Under Who has access to the app, select who should be allowed to visit it. Select: "Anyone".</li>
                    <li>Click Deploy.</li>
                    <li>You will be prompted to allow the application to access your google spreadsheet, if you are not prompted to do it, please run the setup and enable the script to access your spreadsheet;</li>
                    <li>You will get a link like this: <code> https://script.google.com/...</code> </li>
                    <li>You will need this link to send the Extension endpoint;</li>
                </ol>
    
                <h3>Tableau Extension</h3>
                <ol>
                    <li>Download the trex file. Use the button <code>Download Manifest File</code></li>
                    <li>Copy the <code>.trex</code> file from the `manifest` folder to <code> ...\My Tableau Repository\Extensions`</code> so they are available to Tableau (This is not required because you can open it anywhere in your computer, it's just to keep this clean);</li>
                    <li>Launch Tableau and in the Dashoard select the Extension to use.</li>
                </ol>
    
                <h3>Extension Configuration</h3>
                <p>When you run the extension for the first time a Configuration Menu will Pop Up;</p>
                <ol>
                    <li>"Select the Worksheet" from where you want to get the data to see in the extension;</li>
                    <li>"Endpoint URL": Add your URL where, if you used the Google Spreadsheet add the <code>https://script.google.com/...</code> here;</li>
                    <li>"Select the Spreadsheet": If you are using Google Spreadsheet this will set the Sheet name;</li>
                    <li>"Add Columns": This allows you to add new columns to the Extension Table like comments that you want to add;</li>
                    <li>When you are done just it the "Submit" Button;</li>
                </ol>
            </div>
        </div>
    </div>
</body>
</html>